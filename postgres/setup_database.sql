CREATE TABLE PART
(

    P_PARTKEY     SERIAL,
    P_NAME        VARCHAR(55),
    P_MFGR        CHAR(25),
    P_BRAND       CHAR(10),
    P_TYPE        VARCHAR(25),
    P_SIZE        INTEGER,
    P_CONTAINER   CHAR(10),
    P_RETAILPRICE DECIMAL,
    P_COMMENT     VARCHAR(23)
);

CREATE TABLE SUPPLIER
(
    S_SUPPKEY   SERIAL,
    S_NAME      CHAR(25),
    S_ADDRESS   VARCHAR(40),
    S_NATIONKEY INTEGER NOT NULL, -- references N_NATIONKEY
    S_PHONE     CHAR(15),
    S_ACCTBAL   DECIMAL,
    S_COMMENT   VARCHAR(101)
);

CREATE TABLE PARTSUPP
(
    PS_PARTKEY    INTEGER NOT NULL, -- references P_PARTKEY
    PS_SUPPKEY    INTEGER NOT NULL, -- references S_SUPPKEY
    PS_AVAILQTY   INTEGER,
    PS_SUPPLYCOST DECIMAL,
    PS_COMMENT    VARCHAR(199)
);

CREATE TABLE CUSTOMER
(
    C_CUSTKEY    SERIAL,
    C_NAME       VARCHAR(25),
    C_ADDRESS    VARCHAR(40),
    C_NATIONKEY  INTEGER NOT NULL, -- references N_NATIONKEY
    C_PHONE      CHAR(15),
    C_ACCTBAL    DECIMAL,
    C_MKTSEGMENT CHAR(10),
    C_COMMENT    VARCHAR(117)
);

CREATE TABLE ORDERS
(
    O_ORDERKEY      SERIAL,
    O_CUSTKEY       INTEGER NOT NULL, -- references C_CUSTKEY
    O_ORDERSTATUS   CHAR(1),
    O_TOTALPRICE    DECIMAL,
    O_ORDERDATE     DATE,
    O_ORDERPRIORITY CHAR(15),
    O_CLERK         CHAR(15),
    O_SHIPPRIORITY  INTEGER,
    O_COMMENT       VARCHAR(79)
);

CREATE TABLE LINEITEM
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

CREATE TABLE NATION
(
    N_NATIONKEY SERIAL,
    N_NAME      CHAR(25),
    N_REGIONKEY INTEGER NOT NULL, -- references R_REGIONKEY
    N_COMMENT   VARCHAR(152)
);

CREATE TABLE REGION
(
    R_REGIONKEY SERIAL,
    R_NAME      CHAR(25),
    R_COMMENT   VARCHAR(152)
);

COPY part FROM '/benchbase/tpch_data/part.tbl' WITH (FORMAT csv, DELIMITER '|');

COPY region FROM '/benchbase/tpch_data/region.tbl' WITH (FORMAT csv, DELIMITER '|');

COPY nation FROM '/benchbase/tpch_data/nation.tbl' WITH (FORMAT csv, DELIMITER '|');

COPY supplier FROM '/benchbase/tpch_data/supplier.tbl' WITH (FORMAT csv, DELIMITER '|');

COPY customer FROM '/benchbase/tpch_data/customer.tbl' WITH (FORMAT csv, DELIMITER '|');

COPY partsupp FROM '/benchbase/tpch_data/partsupp.tbl' WITH (FORMAT csv, DELIMITER '|');

COPY orders FROM '/benchbase/tpch_data/orders.tbl' WITH (FORMAT csv, DELIMITER '|');

COPY lineitem FROM '/benchbase/tpch_data/lineitem.tbl' WITH (FORMAT csv, DELIMITER '|');

ALTER TABLE PART ADD PRIMARY KEY (P_PARTKEY);
ALTER TABLE SUPPLIER ADD PRIMARY KEY (S_SUPPKEY);
ALTER TABLE PARTSUPP ADD PRIMARY KEY (PS_PARTKEY, PS_SUPPKEY);
ALTER TABLE CUSTOMER ADD PRIMARY KEY (C_CUSTKEY);
ALTER TABLE ORDERS ADD PRIMARY KEY (O_ORDERKEY);
ALTER TABLE LINEITEM ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE NATION ADD PRIMARY KEY (N_NATIONKEY);
ALTER TABLE REGION ADD PRIMARY KEY (R_REGIONKEY);

-- foreign keys

ALTER TABLE SUPPLIER ADD FOREIGN KEY (S_NATIONKEY) REFERENCES NATION(N_NATIONKEY);

ALTER TABLE PARTSUPP ADD FOREIGN KEY (PS_PARTKEY) REFERENCES PART(P_PARTKEY);
ALTER TABLE PARTSUPP ADD FOREIGN KEY (PS_SUPPKEY) REFERENCES SUPPLIER(S_SUPPKEY);

ALTER TABLE CUSTOMER ADD FOREIGN KEY (C_NATIONKEY) REFERENCES NATION(N_NATIONKEY);

ALTER TABLE ORDERS ADD FOREIGN KEY (O_CUSTKEY) REFERENCES CUSTOMER(C_CUSTKEY);

ALTER TABLE LINEITEM ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);

ALTER TABLE NATION ADD FOREIGN KEY (N_REGIONKEY) REFERENCES REGION(R_REGIONKEY);

-- indexes on the foreign keys

CREATE INDEX IDX_SUPPLIER_NATION_KEY ON SUPPLIER (S_NATIONKEY);

CREATE INDEX IDX_PARTSUPP_PARTKEY ON PARTSUPP (PS_PARTKEY);
CREATE INDEX IDX_PARTSUPP_SUPPKEY ON PARTSUPP (PS_SUPPKEY);

CREATE INDEX IDX_CUSTOMER_NATIONKEY ON CUSTOMER (C_NATIONKEY);

CREATE INDEX IDX_ORDERS_CUSTKEY ON ORDERS (O_CUSTKEY);

CREATE INDEX IDX_LINEITEM_ORDERKEY ON LINEITEM (L_ORDERKEY);
CREATE INDEX IDX_LINEITEM_PART_SUPP ON LINEITEM (L_PARTKEY,L_SUPPKEY);

CREATE INDEX IDX_NATION_REGIONKEY ON NATION (N_REGIONKEY);


-- aditional indexes

CREATE INDEX IDX_LINEITEM_SHIPDATE ON LINEITEM (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);

CREATE INDEX IDX_ORDERS_ORDERDATE ON ORDERS (O_ORDERDATE);

------------------------------------------------------------------------------------------------------------------------
-- tables for UNION queries
------------------------------------------------------------------------------------------------------------------------




-- 1992, 1
DROP TABLE IF EXISTS LINEITEM_1992_1;
CREATE TABLE LINEITEM_1992_1
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1992_1
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1992-1-01' AND L_SHIPDATE < DATE ('1992-1-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1992_1 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1992_1 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1992_1 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1992_1_ORDERKEY ON  LINEITEM_1992_1 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1992_1_PART_SUPP ON LINEITEM_1992_1 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1992_1_SHIPDATE ON  LINEITEM_1992_1 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1992, 2
DROP TABLE IF EXISTS LINEITEM_1992_2;
CREATE TABLE LINEITEM_1992_2
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1992_2
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1992-2-01' AND L_SHIPDATE < DATE ('1992-2-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1992_2 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1992_2 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1992_2 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1992_2_ORDERKEY ON  LINEITEM_1992_2 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1992_2_PART_SUPP ON LINEITEM_1992_2 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1992_2_SHIPDATE ON  LINEITEM_1992_2 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1992, 3
DROP TABLE IF EXISTS LINEITEM_1992_3;
CREATE TABLE LINEITEM_1992_3
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1992_3
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1992-3-01' AND L_SHIPDATE < DATE ('1992-3-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1992_3 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1992_3 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1992_3 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1992_3_ORDERKEY ON  LINEITEM_1992_3 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1992_3_PART_SUPP ON LINEITEM_1992_3 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1992_3_SHIPDATE ON  LINEITEM_1992_3 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1992, 4
DROP TABLE IF EXISTS LINEITEM_1992_4;
CREATE TABLE LINEITEM_1992_4
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1992_4
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1992-4-01' AND L_SHIPDATE < DATE ('1992-4-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1992_4 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1992_4 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1992_4 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1992_4_ORDERKEY ON  LINEITEM_1992_4 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1992_4_PART_SUPP ON LINEITEM_1992_4 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1992_4_SHIPDATE ON  LINEITEM_1992_4 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1992, 5
DROP TABLE IF EXISTS LINEITEM_1992_5;
CREATE TABLE LINEITEM_1992_5
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1992_5
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1992-5-01' AND L_SHIPDATE < DATE ('1992-5-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1992_5 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1992_5 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1992_5 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1992_5_ORDERKEY ON  LINEITEM_1992_5 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1992_5_PART_SUPP ON LINEITEM_1992_5 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1992_5_SHIPDATE ON  LINEITEM_1992_5 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1992, 6
DROP TABLE IF EXISTS LINEITEM_1992_6;
CREATE TABLE LINEITEM_1992_6
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1992_6
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1992-6-01' AND L_SHIPDATE < DATE ('1992-6-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1992_6 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1992_6 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1992_6 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1992_6_ORDERKEY ON  LINEITEM_1992_6 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1992_6_PART_SUPP ON LINEITEM_1992_6 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1992_6_SHIPDATE ON  LINEITEM_1992_6 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1992, 7
DROP TABLE IF EXISTS LINEITEM_1992_7;
CREATE TABLE LINEITEM_1992_7
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1992_7
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1992-7-01' AND L_SHIPDATE < DATE ('1992-7-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1992_7 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1992_7 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1992_7 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1992_7_ORDERKEY ON  LINEITEM_1992_7 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1992_7_PART_SUPP ON LINEITEM_1992_7 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1992_7_SHIPDATE ON  LINEITEM_1992_7 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1992, 8
DROP TABLE IF EXISTS LINEITEM_1992_8;
CREATE TABLE LINEITEM_1992_8
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1992_8
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1992-8-01' AND L_SHIPDATE < DATE ('1992-8-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1992_8 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1992_8 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1992_8 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1992_8_ORDERKEY ON  LINEITEM_1992_8 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1992_8_PART_SUPP ON LINEITEM_1992_8 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1992_8_SHIPDATE ON  LINEITEM_1992_8 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1992, 9
DROP TABLE IF EXISTS LINEITEM_1992_9;
CREATE TABLE LINEITEM_1992_9
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1992_9
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1992-9-01' AND L_SHIPDATE < DATE ('1992-9-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1992_9 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1992_9 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1992_9 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1992_9_ORDERKEY ON  LINEITEM_1992_9 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1992_9_PART_SUPP ON LINEITEM_1992_9 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1992_9_SHIPDATE ON  LINEITEM_1992_9 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1992, 10
DROP TABLE IF EXISTS LINEITEM_1992_10;
CREATE TABLE LINEITEM_1992_10
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1992_10
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1992-10-01' AND L_SHIPDATE < DATE ('1992-10-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1992_10 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1992_10 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1992_10 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1992_10_ORDERKEY ON  LINEITEM_1992_10 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1992_10_PART_SUPP ON LINEITEM_1992_10 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1992_10_SHIPDATE ON  LINEITEM_1992_10 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1992, 11
DROP TABLE IF EXISTS LINEITEM_1992_11;
CREATE TABLE LINEITEM_1992_11
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1992_11
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1992-11-01' AND L_SHIPDATE < DATE ('1992-11-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1992_11 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1992_11 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1992_11 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1992_11_ORDERKEY ON  LINEITEM_1992_11 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1992_11_PART_SUPP ON LINEITEM_1992_11 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1992_11_SHIPDATE ON  LINEITEM_1992_11 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1992, 12
DROP TABLE IF EXISTS LINEITEM_1992_12;
CREATE TABLE LINEITEM_1992_12
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1992_12
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1992-12-01' AND L_SHIPDATE < DATE ('1992-12-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1992_12 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1992_12 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1992_12 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1992_12_ORDERKEY ON  LINEITEM_1992_12 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1992_12_PART_SUPP ON LINEITEM_1992_12 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1992_12_SHIPDATE ON  LINEITEM_1992_12 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1993, 1
DROP TABLE IF EXISTS LINEITEM_1993_1;
CREATE TABLE LINEITEM_1993_1
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1993_1
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1993-1-01' AND L_SHIPDATE < DATE ('1993-1-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1993_1 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1993_1 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1993_1 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1993_1_ORDERKEY ON  LINEITEM_1993_1 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1993_1_PART_SUPP ON LINEITEM_1993_1 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1993_1_SHIPDATE ON  LINEITEM_1993_1 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1993, 2
DROP TABLE IF EXISTS LINEITEM_1993_2;
CREATE TABLE LINEITEM_1993_2
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1993_2
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1993-2-01' AND L_SHIPDATE < DATE ('1993-2-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1993_2 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1993_2 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1993_2 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1993_2_ORDERKEY ON  LINEITEM_1993_2 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1993_2_PART_SUPP ON LINEITEM_1993_2 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1993_2_SHIPDATE ON  LINEITEM_1993_2 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1993, 3
DROP TABLE IF EXISTS LINEITEM_1993_3;
CREATE TABLE LINEITEM_1993_3
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1993_3
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1993-3-01' AND L_SHIPDATE < DATE ('1993-3-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1993_3 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1993_3 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1993_3 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1993_3_ORDERKEY ON  LINEITEM_1993_3 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1993_3_PART_SUPP ON LINEITEM_1993_3 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1993_3_SHIPDATE ON  LINEITEM_1993_3 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1993, 4
DROP TABLE IF EXISTS LINEITEM_1993_4;
CREATE TABLE LINEITEM_1993_4
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1993_4
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1993-4-01' AND L_SHIPDATE < DATE ('1993-4-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1993_4 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1993_4 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1993_4 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1993_4_ORDERKEY ON  LINEITEM_1993_4 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1993_4_PART_SUPP ON LINEITEM_1993_4 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1993_4_SHIPDATE ON  LINEITEM_1993_4 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1993, 5
DROP TABLE IF EXISTS LINEITEM_1993_5;
CREATE TABLE LINEITEM_1993_5
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1993_5
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1993-5-01' AND L_SHIPDATE < DATE ('1993-5-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1993_5 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1993_5 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1993_5 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1993_5_ORDERKEY ON  LINEITEM_1993_5 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1993_5_PART_SUPP ON LINEITEM_1993_5 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1993_5_SHIPDATE ON  LINEITEM_1993_5 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1993, 6
DROP TABLE IF EXISTS LINEITEM_1993_6;
CREATE TABLE LINEITEM_1993_6
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1993_6
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1993-6-01' AND L_SHIPDATE < DATE ('1993-6-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1993_6 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1993_6 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1993_6 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1993_6_ORDERKEY ON  LINEITEM_1993_6 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1993_6_PART_SUPP ON LINEITEM_1993_6 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1993_6_SHIPDATE ON  LINEITEM_1993_6 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1993, 7
DROP TABLE IF EXISTS LINEITEM_1993_7;
CREATE TABLE LINEITEM_1993_7
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1993_7
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1993-7-01' AND L_SHIPDATE < DATE ('1993-7-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1993_7 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1993_7 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1993_7 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1993_7_ORDERKEY ON  LINEITEM_1993_7 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1993_7_PART_SUPP ON LINEITEM_1993_7 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1993_7_SHIPDATE ON  LINEITEM_1993_7 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1993, 8
DROP TABLE IF EXISTS LINEITEM_1993_8;
CREATE TABLE LINEITEM_1993_8
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1993_8
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1993-8-01' AND L_SHIPDATE < DATE ('1993-8-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1993_8 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1993_8 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1993_8 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1993_8_ORDERKEY ON  LINEITEM_1993_8 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1993_8_PART_SUPP ON LINEITEM_1993_8 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1993_8_SHIPDATE ON  LINEITEM_1993_8 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1993, 9
DROP TABLE IF EXISTS LINEITEM_1993_9;
CREATE TABLE LINEITEM_1993_9
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1993_9
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1993-9-01' AND L_SHIPDATE < DATE ('1993-9-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1993_9 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1993_9 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1993_9 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1993_9_ORDERKEY ON  LINEITEM_1993_9 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1993_9_PART_SUPP ON LINEITEM_1993_9 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1993_9_SHIPDATE ON  LINEITEM_1993_9 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1993, 10
DROP TABLE IF EXISTS LINEITEM_1993_10;
CREATE TABLE LINEITEM_1993_10
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1993_10
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1993-10-01' AND L_SHIPDATE < DATE ('1993-10-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1993_10 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1993_10 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1993_10 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1993_10_ORDERKEY ON  LINEITEM_1993_10 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1993_10_PART_SUPP ON LINEITEM_1993_10 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1993_10_SHIPDATE ON  LINEITEM_1993_10 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1993, 11
DROP TABLE IF EXISTS LINEITEM_1993_11;
CREATE TABLE LINEITEM_1993_11
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1993_11
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1993-11-01' AND L_SHIPDATE < DATE ('1993-11-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1993_11 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1993_11 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1993_11 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1993_11_ORDERKEY ON  LINEITEM_1993_11 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1993_11_PART_SUPP ON LINEITEM_1993_11 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1993_11_SHIPDATE ON  LINEITEM_1993_11 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1993, 12
DROP TABLE IF EXISTS LINEITEM_1993_12;
CREATE TABLE LINEITEM_1993_12
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1993_12
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1993-12-01' AND L_SHIPDATE < DATE ('1993-12-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1993_12 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1993_12 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1993_12 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1993_12_ORDERKEY ON  LINEITEM_1993_12 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1993_12_PART_SUPP ON LINEITEM_1993_12 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1993_12_SHIPDATE ON  LINEITEM_1993_12 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1994, 1
DROP TABLE IF EXISTS LINEITEM_1994_1;
CREATE TABLE LINEITEM_1994_1
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1994_1
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1994-1-01' AND L_SHIPDATE < DATE ('1994-1-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1994_1 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1994_1 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1994_1 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1994_1_ORDERKEY ON  LINEITEM_1994_1 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1994_1_PART_SUPP ON LINEITEM_1994_1 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1994_1_SHIPDATE ON  LINEITEM_1994_1 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1994, 2
DROP TABLE IF EXISTS LINEITEM_1994_2;
CREATE TABLE LINEITEM_1994_2
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1994_2
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1994-2-01' AND L_SHIPDATE < DATE ('1994-2-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1994_2 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1994_2 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1994_2 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1994_2_ORDERKEY ON  LINEITEM_1994_2 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1994_2_PART_SUPP ON LINEITEM_1994_2 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1994_2_SHIPDATE ON  LINEITEM_1994_2 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1994, 3
DROP TABLE IF EXISTS LINEITEM_1994_3;
CREATE TABLE LINEITEM_1994_3
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1994_3
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1994-3-01' AND L_SHIPDATE < DATE ('1994-3-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1994_3 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1994_3 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1994_3 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1994_3_ORDERKEY ON  LINEITEM_1994_3 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1994_3_PART_SUPP ON LINEITEM_1994_3 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1994_3_SHIPDATE ON  LINEITEM_1994_3 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1994, 4
DROP TABLE IF EXISTS LINEITEM_1994_4;
CREATE TABLE LINEITEM_1994_4
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1994_4
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1994-4-01' AND L_SHIPDATE < DATE ('1994-4-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1994_4 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1994_4 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1994_4 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1994_4_ORDERKEY ON  LINEITEM_1994_4 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1994_4_PART_SUPP ON LINEITEM_1994_4 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1994_4_SHIPDATE ON  LINEITEM_1994_4 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1994, 5
DROP TABLE IF EXISTS LINEITEM_1994_5;
CREATE TABLE LINEITEM_1994_5
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1994_5
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1994-5-01' AND L_SHIPDATE < DATE ('1994-5-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1994_5 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1994_5 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1994_5 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1994_5_ORDERKEY ON  LINEITEM_1994_5 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1994_5_PART_SUPP ON LINEITEM_1994_5 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1994_5_SHIPDATE ON  LINEITEM_1994_5 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1994, 6
DROP TABLE IF EXISTS LINEITEM_1994_6;
CREATE TABLE LINEITEM_1994_6
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1994_6
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1994-6-01' AND L_SHIPDATE < DATE ('1994-6-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1994_6 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1994_6 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1994_6 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1994_6_ORDERKEY ON  LINEITEM_1994_6 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1994_6_PART_SUPP ON LINEITEM_1994_6 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1994_6_SHIPDATE ON  LINEITEM_1994_6 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1994, 7
DROP TABLE IF EXISTS LINEITEM_1994_7;
CREATE TABLE LINEITEM_1994_7
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1994_7
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1994-7-01' AND L_SHIPDATE < DATE ('1994-7-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1994_7 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1994_7 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1994_7 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1994_7_ORDERKEY ON  LINEITEM_1994_7 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1994_7_PART_SUPP ON LINEITEM_1994_7 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1994_7_SHIPDATE ON  LINEITEM_1994_7 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1994, 8
DROP TABLE IF EXISTS LINEITEM_1994_8;
CREATE TABLE LINEITEM_1994_8
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1994_8
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1994-8-01' AND L_SHIPDATE < DATE ('1994-8-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1994_8 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1994_8 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1994_8 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1994_8_ORDERKEY ON  LINEITEM_1994_8 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1994_8_PART_SUPP ON LINEITEM_1994_8 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1994_8_SHIPDATE ON  LINEITEM_1994_8 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1994, 9
DROP TABLE IF EXISTS LINEITEM_1994_9;
CREATE TABLE LINEITEM_1994_9
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1994_9
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1994-9-01' AND L_SHIPDATE < DATE ('1994-9-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1994_9 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1994_9 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1994_9 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1994_9_ORDERKEY ON  LINEITEM_1994_9 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1994_9_PART_SUPP ON LINEITEM_1994_9 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1994_9_SHIPDATE ON  LINEITEM_1994_9 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1994, 10
DROP TABLE IF EXISTS LINEITEM_1994_10;
CREATE TABLE LINEITEM_1994_10
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1994_10
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1994-10-01' AND L_SHIPDATE < DATE ('1994-10-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1994_10 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1994_10 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1994_10 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1994_10_ORDERKEY ON  LINEITEM_1994_10 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1994_10_PART_SUPP ON LINEITEM_1994_10 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1994_10_SHIPDATE ON  LINEITEM_1994_10 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1994, 11
DROP TABLE IF EXISTS LINEITEM_1994_11;
CREATE TABLE LINEITEM_1994_11
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1994_11
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1994-11-01' AND L_SHIPDATE < DATE ('1994-11-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1994_11 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1994_11 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1994_11 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1994_11_ORDERKEY ON  LINEITEM_1994_11 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1994_11_PART_SUPP ON LINEITEM_1994_11 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1994_11_SHIPDATE ON  LINEITEM_1994_11 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1994, 12
DROP TABLE IF EXISTS LINEITEM_1994_12;
CREATE TABLE LINEITEM_1994_12
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1994_12
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1994-12-01' AND L_SHIPDATE < DATE ('1994-12-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1994_12 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1994_12 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1994_12 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1994_12_ORDERKEY ON  LINEITEM_1994_12 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1994_12_PART_SUPP ON LINEITEM_1994_12 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1994_12_SHIPDATE ON  LINEITEM_1994_12 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1995, 1
DROP TABLE IF EXISTS LINEITEM_1995_1;
CREATE TABLE LINEITEM_1995_1
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1995_1
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1995-1-01' AND L_SHIPDATE < DATE ('1995-1-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1995_1 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1995_1 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1995_1 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1995_1_ORDERKEY ON  LINEITEM_1995_1 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1995_1_PART_SUPP ON LINEITEM_1995_1 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1995_1_SHIPDATE ON  LINEITEM_1995_1 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1995, 2
DROP TABLE IF EXISTS LINEITEM_1995_2;
CREATE TABLE LINEITEM_1995_2
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1995_2
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1995-2-01' AND L_SHIPDATE < DATE ('1995-2-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1995_2 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1995_2 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1995_2 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1995_2_ORDERKEY ON  LINEITEM_1995_2 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1995_2_PART_SUPP ON LINEITEM_1995_2 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1995_2_SHIPDATE ON  LINEITEM_1995_2 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1995, 3
DROP TABLE IF EXISTS LINEITEM_1995_3;
CREATE TABLE LINEITEM_1995_3
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1995_3
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1995-3-01' AND L_SHIPDATE < DATE ('1995-3-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1995_3 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1995_3 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1995_3 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1995_3_ORDERKEY ON  LINEITEM_1995_3 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1995_3_PART_SUPP ON LINEITEM_1995_3 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1995_3_SHIPDATE ON  LINEITEM_1995_3 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1995, 4
DROP TABLE IF EXISTS LINEITEM_1995_4;
CREATE TABLE LINEITEM_1995_4
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1995_4
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1995-4-01' AND L_SHIPDATE < DATE ('1995-4-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1995_4 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1995_4 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1995_4 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1995_4_ORDERKEY ON  LINEITEM_1995_4 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1995_4_PART_SUPP ON LINEITEM_1995_4 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1995_4_SHIPDATE ON  LINEITEM_1995_4 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1995, 5
DROP TABLE IF EXISTS LINEITEM_1995_5;
CREATE TABLE LINEITEM_1995_5
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1995_5
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1995-5-01' AND L_SHIPDATE < DATE ('1995-5-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1995_5 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1995_5 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1995_5 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1995_5_ORDERKEY ON  LINEITEM_1995_5 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1995_5_PART_SUPP ON LINEITEM_1995_5 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1995_5_SHIPDATE ON  LINEITEM_1995_5 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1995, 6
DROP TABLE IF EXISTS LINEITEM_1995_6;
CREATE TABLE LINEITEM_1995_6
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1995_6
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1995-6-01' AND L_SHIPDATE < DATE ('1995-6-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1995_6 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1995_6 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1995_6 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1995_6_ORDERKEY ON  LINEITEM_1995_6 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1995_6_PART_SUPP ON LINEITEM_1995_6 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1995_6_SHIPDATE ON  LINEITEM_1995_6 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1995, 7
DROP TABLE IF EXISTS LINEITEM_1995_7;
CREATE TABLE LINEITEM_1995_7
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1995_7
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1995-7-01' AND L_SHIPDATE < DATE ('1995-7-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1995_7 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1995_7 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1995_7 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1995_7_ORDERKEY ON  LINEITEM_1995_7 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1995_7_PART_SUPP ON LINEITEM_1995_7 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1995_7_SHIPDATE ON  LINEITEM_1995_7 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1995, 8
DROP TABLE IF EXISTS LINEITEM_1995_8;
CREATE TABLE LINEITEM_1995_8
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1995_8
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1995-8-01' AND L_SHIPDATE < DATE ('1995-8-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1995_8 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1995_8 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1995_8 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1995_8_ORDERKEY ON  LINEITEM_1995_8 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1995_8_PART_SUPP ON LINEITEM_1995_8 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1995_8_SHIPDATE ON  LINEITEM_1995_8 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1995, 9
DROP TABLE IF EXISTS LINEITEM_1995_9;
CREATE TABLE LINEITEM_1995_9
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1995_9
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1995-9-01' AND L_SHIPDATE < DATE ('1995-9-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1995_9 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1995_9 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1995_9 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1995_9_ORDERKEY ON  LINEITEM_1995_9 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1995_9_PART_SUPP ON LINEITEM_1995_9 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1995_9_SHIPDATE ON  LINEITEM_1995_9 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1995, 10
DROP TABLE IF EXISTS LINEITEM_1995_10;
CREATE TABLE LINEITEM_1995_10
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1995_10
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1995-10-01' AND L_SHIPDATE < DATE ('1995-10-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1995_10 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1995_10 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1995_10 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1995_10_ORDERKEY ON  LINEITEM_1995_10 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1995_10_PART_SUPP ON LINEITEM_1995_10 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1995_10_SHIPDATE ON  LINEITEM_1995_10 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1995, 11
DROP TABLE IF EXISTS LINEITEM_1995_11;
CREATE TABLE LINEITEM_1995_11
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1995_11
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1995-11-01' AND L_SHIPDATE < DATE ('1995-11-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1995_11 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1995_11 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1995_11 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1995_11_ORDERKEY ON  LINEITEM_1995_11 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1995_11_PART_SUPP ON LINEITEM_1995_11 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1995_11_SHIPDATE ON  LINEITEM_1995_11 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1995, 12
DROP TABLE IF EXISTS LINEITEM_1995_12;
CREATE TABLE LINEITEM_1995_12
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1995_12
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1995-12-01' AND L_SHIPDATE < DATE ('1995-12-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1995_12 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1995_12 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1995_12 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1995_12_ORDERKEY ON  LINEITEM_1995_12 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1995_12_PART_SUPP ON LINEITEM_1995_12 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1995_12_SHIPDATE ON  LINEITEM_1995_12 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1996, 1
DROP TABLE IF EXISTS LINEITEM_1996_1;
CREATE TABLE LINEITEM_1996_1
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1996_1
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1996-1-01' AND L_SHIPDATE < DATE ('1996-1-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1996_1 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1996_1 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1996_1 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1996_1_ORDERKEY ON  LINEITEM_1996_1 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1996_1_PART_SUPP ON LINEITEM_1996_1 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1996_1_SHIPDATE ON  LINEITEM_1996_1 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1996, 2
DROP TABLE IF EXISTS LINEITEM_1996_2;
CREATE TABLE LINEITEM_1996_2
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1996_2
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1996-2-01' AND L_SHIPDATE < DATE ('1996-2-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1996_2 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1996_2 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1996_2 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1996_2_ORDERKEY ON  LINEITEM_1996_2 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1996_2_PART_SUPP ON LINEITEM_1996_2 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1996_2_SHIPDATE ON  LINEITEM_1996_2 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1996, 3
DROP TABLE IF EXISTS LINEITEM_1996_3;
CREATE TABLE LINEITEM_1996_3
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1996_3
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1996-3-01' AND L_SHIPDATE < DATE ('1996-3-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1996_3 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1996_3 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1996_3 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1996_3_ORDERKEY ON  LINEITEM_1996_3 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1996_3_PART_SUPP ON LINEITEM_1996_3 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1996_3_SHIPDATE ON  LINEITEM_1996_3 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1996, 4
DROP TABLE IF EXISTS LINEITEM_1996_4;
CREATE TABLE LINEITEM_1996_4
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1996_4
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1996-4-01' AND L_SHIPDATE < DATE ('1996-4-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1996_4 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1996_4 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1996_4 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1996_4_ORDERKEY ON  LINEITEM_1996_4 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1996_4_PART_SUPP ON LINEITEM_1996_4 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1996_4_SHIPDATE ON  LINEITEM_1996_4 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1996, 5
DROP TABLE IF EXISTS LINEITEM_1996_5;
CREATE TABLE LINEITEM_1996_5
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1996_5
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1996-5-01' AND L_SHIPDATE < DATE ('1996-5-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1996_5 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1996_5 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1996_5 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1996_5_ORDERKEY ON  LINEITEM_1996_5 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1996_5_PART_SUPP ON LINEITEM_1996_5 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1996_5_SHIPDATE ON  LINEITEM_1996_5 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1996, 6
DROP TABLE IF EXISTS LINEITEM_1996_6;
CREATE TABLE LINEITEM_1996_6
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1996_6
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1996-6-01' AND L_SHIPDATE < DATE ('1996-6-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1996_6 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1996_6 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1996_6 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1996_6_ORDERKEY ON  LINEITEM_1996_6 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1996_6_PART_SUPP ON LINEITEM_1996_6 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1996_6_SHIPDATE ON  LINEITEM_1996_6 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1996, 7
DROP TABLE IF EXISTS LINEITEM_1996_7;
CREATE TABLE LINEITEM_1996_7
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1996_7
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1996-7-01' AND L_SHIPDATE < DATE ('1996-7-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1996_7 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1996_7 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1996_7 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1996_7_ORDERKEY ON  LINEITEM_1996_7 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1996_7_PART_SUPP ON LINEITEM_1996_7 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1996_7_SHIPDATE ON  LINEITEM_1996_7 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1996, 8
DROP TABLE IF EXISTS LINEITEM_1996_8;
CREATE TABLE LINEITEM_1996_8
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1996_8
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1996-8-01' AND L_SHIPDATE < DATE ('1996-8-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1996_8 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1996_8 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1996_8 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1996_8_ORDERKEY ON  LINEITEM_1996_8 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1996_8_PART_SUPP ON LINEITEM_1996_8 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1996_8_SHIPDATE ON  LINEITEM_1996_8 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1996, 9
DROP TABLE IF EXISTS LINEITEM_1996_9;
CREATE TABLE LINEITEM_1996_9
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1996_9
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1996-9-01' AND L_SHIPDATE < DATE ('1996-9-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1996_9 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1996_9 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1996_9 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1996_9_ORDERKEY ON  LINEITEM_1996_9 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1996_9_PART_SUPP ON LINEITEM_1996_9 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1996_9_SHIPDATE ON  LINEITEM_1996_9 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1996, 10
DROP TABLE IF EXISTS LINEITEM_1996_10;
CREATE TABLE LINEITEM_1996_10
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1996_10
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1996-10-01' AND L_SHIPDATE < DATE ('1996-10-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1996_10 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1996_10 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1996_10 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1996_10_ORDERKEY ON  LINEITEM_1996_10 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1996_10_PART_SUPP ON LINEITEM_1996_10 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1996_10_SHIPDATE ON  LINEITEM_1996_10 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1996, 11
DROP TABLE IF EXISTS LINEITEM_1996_11;
CREATE TABLE LINEITEM_1996_11
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1996_11
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1996-11-01' AND L_SHIPDATE < DATE ('1996-11-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1996_11 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1996_11 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1996_11 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1996_11_ORDERKEY ON  LINEITEM_1996_11 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1996_11_PART_SUPP ON LINEITEM_1996_11 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1996_11_SHIPDATE ON  LINEITEM_1996_11 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1996, 12
DROP TABLE IF EXISTS LINEITEM_1996_12;
CREATE TABLE LINEITEM_1996_12
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1996_12
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1996-12-01' AND L_SHIPDATE < DATE ('1996-12-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1996_12 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1996_12 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1996_12 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1996_12_ORDERKEY ON  LINEITEM_1996_12 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1996_12_PART_SUPP ON LINEITEM_1996_12 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1996_12_SHIPDATE ON  LINEITEM_1996_12 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1997, 1
DROP TABLE IF EXISTS LINEITEM_1997_1;
CREATE TABLE LINEITEM_1997_1
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1997_1
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1997-1-01' AND L_SHIPDATE < DATE ('1997-1-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1997_1 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1997_1 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1997_1 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1997_1_ORDERKEY ON  LINEITEM_1997_1 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1997_1_PART_SUPP ON LINEITEM_1997_1 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1997_1_SHIPDATE ON  LINEITEM_1997_1 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1997, 2
DROP TABLE IF EXISTS LINEITEM_1997_2;
CREATE TABLE LINEITEM_1997_2
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1997_2
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1997-2-01' AND L_SHIPDATE < DATE ('1997-2-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1997_2 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1997_2 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1997_2 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1997_2_ORDERKEY ON  LINEITEM_1997_2 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1997_2_PART_SUPP ON LINEITEM_1997_2 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1997_2_SHIPDATE ON  LINEITEM_1997_2 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1997, 3
DROP TABLE IF EXISTS LINEITEM_1997_3;
CREATE TABLE LINEITEM_1997_3
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1997_3
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1997-3-01' AND L_SHIPDATE < DATE ('1997-3-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1997_3 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1997_3 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1997_3 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1997_3_ORDERKEY ON  LINEITEM_1997_3 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1997_3_PART_SUPP ON LINEITEM_1997_3 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1997_3_SHIPDATE ON  LINEITEM_1997_3 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1997, 4
DROP TABLE IF EXISTS LINEITEM_1997_4;
CREATE TABLE LINEITEM_1997_4
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1997_4
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1997-4-01' AND L_SHIPDATE < DATE ('1997-4-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1997_4 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1997_4 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1997_4 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1997_4_ORDERKEY ON  LINEITEM_1997_4 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1997_4_PART_SUPP ON LINEITEM_1997_4 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1997_4_SHIPDATE ON  LINEITEM_1997_4 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1997, 5
DROP TABLE IF EXISTS LINEITEM_1997_5;
CREATE TABLE LINEITEM_1997_5
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1997_5
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1997-5-01' AND L_SHIPDATE < DATE ('1997-5-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1997_5 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1997_5 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1997_5 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1997_5_ORDERKEY ON  LINEITEM_1997_5 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1997_5_PART_SUPP ON LINEITEM_1997_5 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1997_5_SHIPDATE ON  LINEITEM_1997_5 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1997, 6
DROP TABLE IF EXISTS LINEITEM_1997_6;
CREATE TABLE LINEITEM_1997_6
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1997_6
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1997-6-01' AND L_SHIPDATE < DATE ('1997-6-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1997_6 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1997_6 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1997_6 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1997_6_ORDERKEY ON  LINEITEM_1997_6 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1997_6_PART_SUPP ON LINEITEM_1997_6 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1997_6_SHIPDATE ON  LINEITEM_1997_6 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1997, 7
DROP TABLE IF EXISTS LINEITEM_1997_7;
CREATE TABLE LINEITEM_1997_7
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1997_7
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1997-7-01' AND L_SHIPDATE < DATE ('1997-7-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1997_7 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1997_7 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1997_7 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1997_7_ORDERKEY ON  LINEITEM_1997_7 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1997_7_PART_SUPP ON LINEITEM_1997_7 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1997_7_SHIPDATE ON  LINEITEM_1997_7 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1997, 8
DROP TABLE IF EXISTS LINEITEM_1997_8;
CREATE TABLE LINEITEM_1997_8
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1997_8
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1997-8-01' AND L_SHIPDATE < DATE ('1997-8-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1997_8 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1997_8 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1997_8 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1997_8_ORDERKEY ON  LINEITEM_1997_8 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1997_8_PART_SUPP ON LINEITEM_1997_8 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1997_8_SHIPDATE ON  LINEITEM_1997_8 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1997, 9
DROP TABLE IF EXISTS LINEITEM_1997_9;
CREATE TABLE LINEITEM_1997_9
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1997_9
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1997-9-01' AND L_SHIPDATE < DATE ('1997-9-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1997_9 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1997_9 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1997_9 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1997_9_ORDERKEY ON  LINEITEM_1997_9 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1997_9_PART_SUPP ON LINEITEM_1997_9 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1997_9_SHIPDATE ON  LINEITEM_1997_9 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1997, 10
DROP TABLE IF EXISTS LINEITEM_1997_10;
CREATE TABLE LINEITEM_1997_10
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1997_10
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1997-10-01' AND L_SHIPDATE < DATE ('1997-10-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1997_10 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1997_10 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1997_10 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1997_10_ORDERKEY ON  LINEITEM_1997_10 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1997_10_PART_SUPP ON LINEITEM_1997_10 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1997_10_SHIPDATE ON  LINEITEM_1997_10 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1997, 11
DROP TABLE IF EXISTS LINEITEM_1997_11;
CREATE TABLE LINEITEM_1997_11
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1997_11
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1997-11-01' AND L_SHIPDATE < DATE ('1997-11-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1997_11 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1997_11 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1997_11 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1997_11_ORDERKEY ON  LINEITEM_1997_11 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1997_11_PART_SUPP ON LINEITEM_1997_11 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1997_11_SHIPDATE ON  LINEITEM_1997_11 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1997, 12
DROP TABLE IF EXISTS LINEITEM_1997_12;
CREATE TABLE LINEITEM_1997_12
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1997_12
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1997-12-01' AND L_SHIPDATE < DATE ('1997-12-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1997_12 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1997_12 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1997_12 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1997_12_ORDERKEY ON  LINEITEM_1997_12 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1997_12_PART_SUPP ON LINEITEM_1997_12 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1997_12_SHIPDATE ON  LINEITEM_1997_12 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1998, 1
DROP TABLE IF EXISTS LINEITEM_1998_1;
CREATE TABLE LINEITEM_1998_1
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1998_1
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1998-1-01' AND L_SHIPDATE < DATE ('1998-1-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1998_1 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1998_1 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1998_1 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1998_1_ORDERKEY ON  LINEITEM_1998_1 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1998_1_PART_SUPP ON LINEITEM_1998_1 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1998_1_SHIPDATE ON  LINEITEM_1998_1 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1998, 2
DROP TABLE IF EXISTS LINEITEM_1998_2;
CREATE TABLE LINEITEM_1998_2
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1998_2
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1998-2-01' AND L_SHIPDATE < DATE ('1998-2-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1998_2 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1998_2 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1998_2 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1998_2_ORDERKEY ON  LINEITEM_1998_2 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1998_2_PART_SUPP ON LINEITEM_1998_2 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1998_2_SHIPDATE ON  LINEITEM_1998_2 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1998, 3
DROP TABLE IF EXISTS LINEITEM_1998_3;
CREATE TABLE LINEITEM_1998_3
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1998_3
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1998-3-01' AND L_SHIPDATE < DATE ('1998-3-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1998_3 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1998_3 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1998_3 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1998_3_ORDERKEY ON  LINEITEM_1998_3 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1998_3_PART_SUPP ON LINEITEM_1998_3 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1998_3_SHIPDATE ON  LINEITEM_1998_3 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1998, 4
DROP TABLE IF EXISTS LINEITEM_1998_4;
CREATE TABLE LINEITEM_1998_4
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1998_4
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1998-4-01' AND L_SHIPDATE < DATE ('1998-4-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1998_4 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1998_4 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1998_4 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1998_4_ORDERKEY ON  LINEITEM_1998_4 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1998_4_PART_SUPP ON LINEITEM_1998_4 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1998_4_SHIPDATE ON  LINEITEM_1998_4 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1998, 5
DROP TABLE IF EXISTS LINEITEM_1998_5;
CREATE TABLE LINEITEM_1998_5
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1998_5
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1998-5-01' AND L_SHIPDATE < DATE ('1998-5-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1998_5 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1998_5 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1998_5 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1998_5_ORDERKEY ON  LINEITEM_1998_5 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1998_5_PART_SUPP ON LINEITEM_1998_5 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1998_5_SHIPDATE ON  LINEITEM_1998_5 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1998, 6
DROP TABLE IF EXISTS LINEITEM_1998_6;
CREATE TABLE LINEITEM_1998_6
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1998_6
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1998-6-01' AND L_SHIPDATE < DATE ('1998-6-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1998_6 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1998_6 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1998_6 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1998_6_ORDERKEY ON  LINEITEM_1998_6 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1998_6_PART_SUPP ON LINEITEM_1998_6 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1998_6_SHIPDATE ON  LINEITEM_1998_6 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1998, 7
DROP TABLE IF EXISTS LINEITEM_1998_7;
CREATE TABLE LINEITEM_1998_7
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1998_7
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1998-7-01' AND L_SHIPDATE < DATE ('1998-7-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1998_7 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1998_7 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1998_7 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1998_7_ORDERKEY ON  LINEITEM_1998_7 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1998_7_PART_SUPP ON LINEITEM_1998_7 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1998_7_SHIPDATE ON  LINEITEM_1998_7 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1998, 8
DROP TABLE IF EXISTS LINEITEM_1998_8;
CREATE TABLE LINEITEM_1998_8
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1998_8
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1998-8-01' AND L_SHIPDATE < DATE ('1998-8-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1998_8 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1998_8 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1998_8 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1998_8_ORDERKEY ON  LINEITEM_1998_8 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1998_8_PART_SUPP ON LINEITEM_1998_8 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1998_8_SHIPDATE ON  LINEITEM_1998_8 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1998, 9
DROP TABLE IF EXISTS LINEITEM_1998_9;
CREATE TABLE LINEITEM_1998_9
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1998_9
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1998-9-01' AND L_SHIPDATE < DATE ('1998-9-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1998_9 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1998_9 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1998_9 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1998_9_ORDERKEY ON  LINEITEM_1998_9 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1998_9_PART_SUPP ON LINEITEM_1998_9 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1998_9_SHIPDATE ON  LINEITEM_1998_9 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1998, 10
DROP TABLE IF EXISTS LINEITEM_1998_10;
CREATE TABLE LINEITEM_1998_10
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1998_10
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1998-10-01' AND L_SHIPDATE < DATE ('1998-10-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1998_10 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1998_10 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1998_10 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1998_10_ORDERKEY ON  LINEITEM_1998_10 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1998_10_PART_SUPP ON LINEITEM_1998_10 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1998_10_SHIPDATE ON  LINEITEM_1998_10 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1998, 11
DROP TABLE IF EXISTS LINEITEM_1998_11;
CREATE TABLE LINEITEM_1998_11
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1998_11
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1998-11-01' AND L_SHIPDATE < DATE ('1998-11-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1998_11 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1998_11 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1998_11 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1998_11_ORDERKEY ON  LINEITEM_1998_11 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1998_11_PART_SUPP ON LINEITEM_1998_11 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1998_11_SHIPDATE ON  LINEITEM_1998_11 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


-- 1998, 12
DROP TABLE IF EXISTS LINEITEM_1998_12;
CREATE TABLE LINEITEM_1998_12
(
    L_ORDERKEY      INTEGER NOT NULL, -- references O_ORDERKEY
    L_PARTKEY       INTEGER NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
    L_SUPPKEY       INTEGER NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
    L_LINENUMBER    INTEGER,
    L_QUANTITY      DECIMAL,
    L_EXTENDEDPRICE DECIMAL,
    L_DISCOUNT      DECIMAL,
    L_TAX           DECIMAL,
    L_RETURNFLAG    CHAR(1),
    L_LINESTATUS    CHAR(1),
    L_SHIPDATE      DATE,
    L_COMMITDATE    DATE,
    L_RECEIPTDATE   DATE,
    L_SHIPINSTRUCT  CHAR(25),
    L_SHIPMODE      CHAR(10),
    L_COMMENT       VARCHAR(44)
);

INSERT INTO LINEITEM_1998_12
SELECT *
FROM LINEITEM
WHERE L_SHIPDATE > DATE '1998-12-01' AND L_SHIPDATE < DATE ('1998-12-01'+ INTERVAL '1 MONTH');

ALTER TABLE LINEITEM_1998_12 ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
ALTER TABLE LINEITEM_1998_12 ADD FOREIGN KEY (L_ORDERKEY) REFERENCES ORDERS(O_ORDERKEY);
ALTER TABLE LINEITEM_1998_12 ADD FOREIGN KEY (L_PARTKEY,L_SUPPKEY) REFERENCES PARTSUPP(PS_PARTKEY,PS_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1998_12_ORDERKEY ON  LINEITEM_1998_12 (L_ORDERKEY);
--CREATE INDEX IDX_LINEITEM_1998_12_PART_SUPP ON LINEITEM_1998_12 (L_PARTKEY,L_SUPPKEY);
--CREATE INDEX IDX_LINEITEM_1998_12_SHIPDATE ON  LINEITEM_1998_12 (L_SHIPDATE, L_DISCOUNT, L_QUANTITY);


WITH LINEITEM_NEW AS (SELECT * FROM LINEITEM_1992_1
UNION
SELECT * FROM LINEITEM_1992_2
UNION
SELECT * FROM LINEITEM_1992_3
UNION
SELECT * FROM LINEITEM_1992_4
UNION
SELECT * FROM LINEITEM_1992_5
UNION
SELECT * FROM LINEITEM_1992_6
UNION
SELECT * FROM LINEITEM_1992_7
UNION
SELECT * FROM LINEITEM_1992_8
UNION
SELECT * FROM LINEITEM_1992_9
UNION
SELECT * FROM LINEITEM_1992_10
UNION
SELECT * FROM LINEITEM_1992_11
UNION
SELECT * FROM LINEITEM_1992_12
UNION
SELECT * FROM LINEITEM_1993_1
UNION
SELECT * FROM LINEITEM_1993_2
UNION
SELECT * FROM LINEITEM_1993_3
UNION
SELECT * FROM LINEITEM_1993_4
UNION
SELECT * FROM LINEITEM_1993_5
UNION
SELECT * FROM LINEITEM_1993_6
UNION
SELECT * FROM LINEITEM_1993_7
UNION
SELECT * FROM LINEITEM_1993_8
UNION
SELECT * FROM LINEITEM_1993_9
UNION
SELECT * FROM LINEITEM_1993_10
UNION
SELECT * FROM LINEITEM_1993_11
UNION
SELECT * FROM LINEITEM_1993_12
UNION
SELECT * FROM LINEITEM_1994_1
UNION
SELECT * FROM LINEITEM_1994_2
UNION
SELECT * FROM LINEITEM_1994_3
UNION
SELECT * FROM LINEITEM_1994_4
UNION
SELECT * FROM LINEITEM_1994_5
UNION
SELECT * FROM LINEITEM_1994_6
UNION
SELECT * FROM LINEITEM_1994_7
UNION
SELECT * FROM LINEITEM_1994_8
UNION
SELECT * FROM LINEITEM_1994_9
UNION
SELECT * FROM LINEITEM_1994_10
UNION
SELECT * FROM LINEITEM_1994_11
UNION
SELECT * FROM LINEITEM_1994_12
UNION
SELECT * FROM LINEITEM_1995_1
UNION
SELECT * FROM LINEITEM_1995_2
UNION
SELECT * FROM LINEITEM_1995_3
UNION
SELECT * FROM LINEITEM_1995_4
UNION
SELECT * FROM LINEITEM_1995_5
UNION
SELECT * FROM LINEITEM_1995_6
UNION
SELECT * FROM LINEITEM_1995_7
UNION
SELECT * FROM LINEITEM_1995_8
UNION
SELECT * FROM LINEITEM_1995_9
UNION
SELECT * FROM LINEITEM_1995_10
UNION
SELECT * FROM LINEITEM_1995_11
UNION
SELECT * FROM LINEITEM_1995_12
UNION
SELECT * FROM LINEITEM_1996_1
UNION
SELECT * FROM LINEITEM_1996_2
UNION
SELECT * FROM LINEITEM_1996_3
UNION
SELECT * FROM LINEITEM_1996_4
UNION
SELECT * FROM LINEITEM_1996_5
UNION
SELECT * FROM LINEITEM_1996_6
UNION
SELECT * FROM LINEITEM_1996_7
UNION
SELECT * FROM LINEITEM_1996_8
UNION
SELECT * FROM LINEITEM_1996_9
UNION
SELECT * FROM LINEITEM_1996_10
UNION
SELECT * FROM LINEITEM_1996_11
UNION
SELECT * FROM LINEITEM_1996_12
UNION
SELECT * FROM LINEITEM_1997_1
UNION
SELECT * FROM LINEITEM_1997_2
UNION
SELECT * FROM LINEITEM_1997_3
UNION
SELECT * FROM LINEITEM_1997_4
UNION
SELECT * FROM LINEITEM_1997_5
UNION
SELECT * FROM LINEITEM_1997_6
UNION
SELECT * FROM LINEITEM_1997_7
UNION
SELECT * FROM LINEITEM_1997_8
UNION
SELECT * FROM LINEITEM_1997_9
UNION
SELECT * FROM LINEITEM_1997_10
UNION
SELECT * FROM LINEITEM_1997_11
UNION
SELECT * FROM LINEITEM_1997_12
UNION
SELECT * FROM LINEITEM_1998_1
UNION
SELECT * FROM LINEITEM_1998_2
UNION
SELECT * FROM LINEITEM_1998_3
UNION
SELECT * FROM LINEITEM_1998_4
UNION
SELECT * FROM LINEITEM_1998_5
UNION
SELECT * FROM LINEITEM_1998_6
UNION
SELECT * FROM LINEITEM_1998_7
UNION
SELECT * FROM LINEITEM_1998_8
UNION
SELECT * FROM LINEITEM_1998_9
UNION
SELECT * FROM LINEITEM_1998_10
UNION
SELECT * FROM LINEITEM_1998_11
UNION
SELECT * FROM LINEITEM_1998_12
)
SELECT
        l_orderkey,
        SUM(l_extendedprice * (1 - l_discount)) as revenue,
        o_orderdate,
        o_shippriority
FROM
        customer,
        orders,
        LINEITEM_NEW
WHERE
        c_mktsegment = 'BUILDING'
        AND c_custkey = o_custkey
        AND l_orderkey = o_orderkey
GROUP BY
        l_orderkey,
        o_orderdate,
        o_shippriority;

